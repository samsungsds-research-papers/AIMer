// SPDX-License-Identifier: MIT

#ifndef AIM2_H
#define AIM2_H

#include <stdint.h>
#include "field.h"

static const GF aim2_constants[AIM2_NUM_INPUT_SBOX] =
{
  {0x24a19947b3916cf7, 0xba7c9045f12c7f99, 0xb8e1afed6a267e96, 0x2ffd72dbd01adfb7},
  {0x0d95748f728eb658, 0xa458fea3f4933d7e, 0x636920d871574e69, 0x0801f2e2858efc16},
  {0xc5d1b023286085f0, 0x9c30d5392af26013, 0x7b54a41dc25a59b5, 0x718bcd5882154aee}
};

static const uint64_t
aim2_exponents[AIM2_NUM_INPUT_SBOX + 1][AIM2_NUM_WORDS_FIELD] =
{
  {0xdadb5b6b6d6dadb5, 0x6b6d6dadb5b6b6d6, 0xadb5b6b6d6dadb5b, 0xb6d6dadb5b6b6d6d},
  {0x1112224444889111, 0x8891112224444889, 0x4448889112222444, 0x2224448889112222},
  {0xeddbb76eddbb76ed, 0x76eddbb76eddbb76, 0xbb76eddbb76eddbb, 0xddbb76eddbb76edd},
  {7, 0, 0}
};

static const unsigned aim2_invmer_exponents[AIM2_NUM_INPUT_SBOX + 1] =
{
  11, 141, 7, 3
};

static const GF aim2_e1_power_matrix[AIM2_NUM_BITS_FIELD] =
{
  {0x0000000000000001, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000},
  {0x0000010000010001, 0x0000000000010000, 0x0000000000000000, 0x0000000000000000},
  {0x0000000100000001, 0x0000000000010000, 0x0000000100000000, 0x0000000000000000},
  {0x0001010100010001, 0x0101000100000100, 0x0001000000000000, 0x0001000000000100},
  {0x0000000000000001, 0x0000000000000424, 0x0000000100000000, 0x0000000000000000},
  {0x0000010000010001, 0x0004240004250424, 0x0001000104240000, 0x0001000000000100},
  {0x0000000100000001, 0x0000042400010001, 0x0000000004240000, 0x0001042400000001},
  {0x0035010531243024, 0x0525052500010534, 0x2024042504212400, 0x0425010000010005},
  {0x0000000000000001, 0x0000000000000425, 0x0000000000100410, 0x0000000000000000},
  {0x0000010000010001, 0x0004250004240425, 0x1004101000250410, 0x0000001004100000},
  {0x4240d65100000001, 0x0000042500010425, 0x0010041104350410, 0x0000043504100000},
  {0xd2400101104713c5, 0xd370216644f31775, 0x3520102504046350, 0x1024041010041114},
  {0x4240d65000000001, 0x0000000000000001, 0x0000000100000424, 0x000004254250d240},
  {0x91019510c344100b, 0xd650014240d61251, 0x0005240104254664, 0x54f606759434d340},
  {0x47419425d3500410, 0x9410d3414241d264, 0x0000042400114375, 0x4251d66404340411},
  {0x5005154771e625b1, 0x92a62617d4a1f683, 0xc62633e081d3d166, 0xa415c3414354b401},
  {0x0004250042542501, 0x0000000000000000, 0x0000000000100411, 0x0000000000000000},
  {0x7121665467552501, 0x2500425421240046, 0x1004111004010415, 0x0000001004110000},
  {0x0010d27442542501, 0x2500425425052500, 0x4244211000100415, 0x0000001004152500},
  {0xc401535177177641, 0xb005250535d65152, 0x3104112021477520, 0x3425045761215244},
  {0x4244f77542542501, 0x1000350013403024, 0x4254250100100411, 0x000000004254f364},
  {0xe014e675a420758f, 0x9245405642920722, 0x4251274134105646, 0x71f22606e104a030},
  {0x43505217d1f23585, 0xa66184042511d274, 0x3510175120347255, 0x7415c35046553110},
  {0x067318f785cf45aa, 0x61a004a4936df702, 0x923747d2e1919341, 0xf525b5041507f341},
  {0x000000004240d651, 0x1004100051141525, 0x40d2744f25d65001, 0x000000004240d237},
  {0x41d613519511c681, 0x1411265492601567, 0xf2cd019d64e24054, 0x349d50d61202cdc4},
  {0x1245c2270397978b, 0x4101466497410525, 0x3744a30b20f74101, 0x671be2c45293b67c},
  {0x67e1dfb5467ae612, 0x8447f7a041bc47e0, 0x256a15fc659576d2, 0xb562ec97e14dcb19},
  {0x5101306744f6a77f, 0x101510010350d241, 0x5240e35113503535, 0x01c2716a36939651},
  {0xa69f7c50e3c89e9b, 0x60a116f67759d344, 0xf125c641e1347522, 0x006f05fbd5148517},
  {0x506b74ea35629198, 0x53d4c6c1a5fb951c, 0x15e7724ce644456b, 0xd750262a00e75572},
  {0x95d21f6d4dc21113, 0x1a6a4a08c94f0fce, 0xe52f5aa0e2f58771, 0x6463b29cf78c5fa7},
  {0x1000341046452124, 0x0000001004110000, 0x0000000000000000, 0x0000000000000000},
  {0x6131565567612124, 0x2500425425010046, 0x0010041100000004, 0x0000000000000000},
  {0x5645153446456374, 0x3001465535353410, 0x4655253500001010, 0x0411000010003410},
  {0x06506775776132f0, 0x5654257327548466, 0x2525003025462361, 0x2110004661257744},
  {0x1000341046456374, 0x40d61340c1253010, 0x46456374d6640042, 0x0411000010003410},
  {0x61314651776170a0, 0x42b684309265e223, 0x5271367530251055, 0x6751d62261314655},
  {0x857207a2b271d6c5, 0xe535425530308511, 0xc524c17774d70340, 0xb640d264460723a2},
  {0xb5613f06245af12f, 0x9047d191132e06c1, 0x9105c575c7c43637, 0xa2704271422474c7},
  {0x1000341046452124, 0x50d6275087601134, 0x41d7260fb0e38202, 0x0100000005110042},
  {0x6125a504676130fe, 0x2387d265b7403472, 0xa30a13dcf5f29253, 0x360ff7b350771ef3},
  {0xb74421463296115f, 0x14d2702596b74120, 0x9021024dd401b546, 0xa57ea195d6c4428b},
  {0x42328be2c09f06d2, 0xf2f0f4b3806ad580, 0xe3fc06eff2173346, 0xc2e428c0000b8bac},
  {0xc515a602f4c220aa, 0xe774340462a37020, 0x06933260e4253004, 0xe740763f44e77552},
  {0x350d2c12023e0a81, 0xd60282a0240d2456, 0x25c7b001d0351607, 0x446a84fb9283f451},
  {0xc139307d61e743a2, 0x7594f2a606ee71da, 0x227043efe0e6552c, 0xf3649768b7650644},
  {0x93053112df49a4ed, 0x593e4f6e0e760dbb, 0x756c899250e24787, 0x42e584c9944ebe40},
  {0xc33e778224141524, 0x514f25c2a3130fb1, 0x51d7505f2491e3b2, 0x0100001001000042},
  {0xe2fd56b23130146a, 0x1000130687f56bab, 0xb5a9658c87b7b360, 0x514f67d035a05ffe},
  {0xc61a95d700522595, 0xa0df0e21042c3b66, 0x749005de5f6f471a, 0xf34c2b72705b76d0},
  {0x20df0761447b0309, 0x17126c99039a4d28, 0x1028443dfc1d00db, 0x8696d432d1947cc0},
  {0x955ab6b61531073a, 0xe6a7035890b419f4, 0x258c60ada382ae15, 0x82e539ab85cb4606},
  {0x568b8650a61a15e6, 0xe7507248d6d57b8b, 0xc4d7467db3608578, 0x10a519c7e1b8288e},
  {0x936c3667e69b7659, 0xc63389d1337eaf53, 0x90675b2f1de17c75, 0xf737c5db9b0876ba},
  {0x39d4ff1305478cde, 0x072a0fa7858349de, 0xa3e50076fd4ef819, 0x61b5f9a2f69c0ff3},
  {0x21e72000b374e220, 0x74d7515a95f76534, 0xe2cc61bc66866162, 0x046e01d3e476ddc1},
  {0x067482555547b2be, 0xf2e843f8f5d26471, 0x544bf0b9b5816ec7, 0x12dc42c194b4f7bc},
  {0xd434a346e631c5d1, 0xe121926b57d6447e, 0x66647718577462ae, 0x1453dfa0463fe8aa},
  {0x9286a168ccb1d444, 0x06485d58e28956b5, 0xf775d95b50363cec, 0x8303648da84c77b8},
  {0xd397061657228922, 0x732ec6f2e4c74e0f, 0x454a87e27232f0c0, 0x72a2240096c1ddd5},
  {0xc142a4da64ce7464, 0x74847ac4b529ef31, 0x36aad164e23ba29d, 0x109d15b6f15309c3},
  {0x859ab67817b7a77a, 0x83759ae26c98c10a, 0xa6a81b022bedd3ee, 0x8746c5e8f0dc2f0f},
  {0x48d18c336c5111dc, 0x372eeb4892515515, 0xca9bb2f44c93376d, 0x8583117fa42608f9},
  {0x1014101104010410, 0x0100000005100100, 0x0010010100000000, 0x0000000000000100},
  {0x0101041425114640, 0x0110010114100010, 0x0111041001001111, 0x0100000011010110},
  {0x1415140104014640, 0x1405200153403034, 0x0411000100001014, 0x0411000010041110},
  {0x0110000000110410, 0x603543543030f750, 0x2401475525001157, 0x0001000000000004},
  {0x1014101531013010, 0x13962374d370f265, 0x20110505f6442442, 0x4754212410141115},
  {0x10462776277140b1, 0x5005a41504011744, 0x42446222b6405313, 0x7764d25434462764},
  {0xc72216d585e7d775, 0xd271c3751401a401, 0xc420c333f7b30654, 0x8135341004531793},
  {0x1063236633163000, 0x067553544775c131, 0x7760745324256613, 0x2501543435573235},
  {0x7782964114475584, 0x03861627d5f7a31f, 0x75010405f6542442, 0x5254703101051004},
  {0xd44675f54abc8000, 0x7443c8e0a0b895c2, 0x330765a5f71f7793, 0x2370831534476375},
  {0xa405c6703047342f, 0x71c3e030f386b660, 0x8135a17656863736, 0x82a3357e27c481c6},
  {0x929e93263ecfcd7a, 0xd1354355761732c9, 0x464432071430d203, 0xd22a82bda4950766},
  {0xe71b76e045e352d8, 0x1674c21f1466f3b3, 0x07c453f1c1b9c4de, 0xf797545e35c29703},
  {0x849d7843427e11e6, 0xc478207dadb8729c, 0x2fee583882162aa5, 0x32afa322a24c7772},
  {0x43ba4300b6d5a1e9, 0x2434533f5376a62a, 0x4181d252a20f17ed, 0x85c2f15711c3a466},
  {0x97b779dc674a5db3, 0x42ad9cdfecf3c474, 0xcffbce0f279b4f30, 0x656324da239a9371},
  {0xe04f81a954951484, 0x546a63f1c3d55fbc, 0x06643525014345c6, 0x1525511404151100},
  {0x9326c5eb6b39f275, 0x636d4851c73a66f9, 0x13f531e7715a0020, 0x6405544434e6660f},
  {0xf23fa49870d26621, 0xd4b11dc174ee7f5f, 0x3043a7e47acba1ac, 0xe7c01eeba7f8f1e6},
  {0x926c51083f1cbe15, 0x8397460f51b495a8, 0x41c7051515254656, 0xa63e25e8b415f16e},
  {0x7254442cb63251cc, 0x2005803514d60e6e, 0x279b1707519d58fc, 0x9332ea99c428262b},
  {0x70fd93783cabd0b5, 0x32124ca31d6c2282, 0x2df1ae6c028f3fb9, 0x468a540b21e826e4},
  {0xe19032a0a5e252c7, 0x81ebef1413db8efa, 0x400108bd0df8de4b, 0x54cb9341c91b5505},
  {0x8038abba9874ffa8, 0x87d1a3cc5e8c7f15, 0x5f765d1fb6a6aa23, 0xd46252e2435d29e2},
  {0x93508265b5054543, 0x03d870b4e5d2c55f, 0x070f96b2b2336194, 0x86b64546b6c1eef3},
  {0xf623ceb307ef4390, 0x23cc7ff03744a008, 0xd2685550ce8845f9, 0x94acb2b336305896},
  {0x3510f225778117ea, 0xd62f47adf550046e, 0x708d55bfe7066021, 0x4317dcd9430af9fc},
  {0x17bb6f4f717e6977, 0x33a3ab49f72366c9, 0x64ff663fac0e2eeb, 0xc08884a55782e0b9},
  {0x915a82972364c8d7, 0xd4c3e40340ebcfab, 0xa7a7d62147874304, 0xa0f2c64d66b68849},
  {0x5449139917c02048, 0x59982c1d1f803faa, 0x12c6d59908cc05dd, 0x0616aedb0a2dda6a},
  {0x250e849743f943ba, 0xe6238e09496974d6, 0x27471f8caa971513, 0x508ec628134f083c},
  {0xe31c3fe4ab64f048, 0x85c952bc71c8feee, 0x21d7ef94e8dcdf77, 0xc62243d7497f45f2},
  {0xd34d616e90bde584, 0x206f66f360526ab5, 0x40200105001705d3, 0x1524105504157504},
  {0x0077e09c12fde584, 0x759823cfa254a21f, 0x30d3b26000170591, 0x1101101754c3104b},
  {0x12fda3fce4f2c1da, 0xe2698c6692694f1d, 0xb67981563fbabfdc, 0x70660ff392ab3500},
  {0x43c4729e672ba7c3, 0xa4bce7efe0c38404, 0x01f6f067a6f729da, 0x55f6a25461f6372f},
  {0x2af28ae702f02e06, 0xf2496444062a3fd6, 0xe1576cf7b7ce2142, 0xf1f24a5489f3f5c3},
  {0x2b880b43e1624f1a, 0x36d5b6b4e6aa337d, 0x27c59fe1e03ebdff, 0x24a4b7880a1e116a},
  {0xfa057f70014f28bd, 0x2111cc571250eb6a, 0x302d6643bb0a1444, 0x12dc378f6314e19a},
  {0xef8f5410e1eac927, 0xc2ddb5b2d4b1139a, 0x902d8b3855e89842, 0x57f175a1bbacb31d},
  {0xc0a9548d8f91663c, 0x926c1a06800cdf38, 0x463f48a3038507c4, 0x05db8675bd78d9b8},
  {0x82a3f43d5c742621, 0xd0382d5b904b55c2, 0x919d0fb8b7635381, 0xb3d480ce5c4caee8},
  {0xa1f7c44d0733acc0, 0x420b23e64287be28, 0xd02da940890d5a8a, 0x700c83703c2a57fa},
  {0x76502c6b15174b09, 0x221e4ef3a664d17b, 0x57d1e888668c5f34, 0x706bcc871cf38555},
  {0x3f7ac137bf57e5f7, 0x245786f66df4dfb1, 0x7df51c42f68df8dc, 0xa7e1e3af177a78fc},
  {0x0d064c1cf9f8e898, 0x9749e56a2ffa94a0, 0x6ab95b1f8666159c, 0x2274fe25624663a8},
  {0xee671acfe8143a6b, 0xc4ab93655503b39f, 0xb2d96e144ebfe5fc, 0xc12db26fad2981de},
  {0x68019c35f251b876, 0x4eb2b19cb8f2c4f4, 0xf04d896cb34faa65, 0x34d78f4b1065e3e2},
  {0xd2c807869473d094, 0x91df0f57c539ba42, 0x8717e79f6f6f106e, 0x5713ce91146b31ae},
  {0xc4393434220af7c4, 0xa0b41ccf66bf4801, 0x00cf23581a4c04bc, 0x152c1b12224cb809},
  {0xa76d5463dbcb1321, 0x370759bee018ec69, 0x735ce30be2edaf57, 0x61de2a1251da4068},
  {0xb14a60f7efe346de, 0x22360bca738e8d14, 0x2446b6c9a68a81dd, 0x7287f156e2060fd1},
  {0x77a3a603859dce11, 0xc7868316f3e13c12, 0x13c4beef9c48d8d2, 0x331764fe2abcc007},
  {0xdc07dc89a260502c, 0x03afe71da28e8801, 0x66e50381fe0b7e04, 0x55c6d519f6d7fbd9},
  {0x2544a6d0aa5edf0d, 0xb6b3e62f7c237cf7, 0x89075b07a7e9bc0e, 0x54a504a396091f6d},
  {0xd14d73fbce484f69, 0xd530c7779a268f9a, 0xdd938e7bd4f60085, 0x021e58ca3231277e},
  {0xe095a4cfe00b47ca, 0x473309c817ae95d6, 0x629f457e6b2e7362, 0xe588c0d086445409},
  {0xd48541aab459f83f, 0x44a1288d539f5b13, 0x005a5bb9be931cd3, 0x247224d83e6a0fce},
  {0x8091fdbcd0882eb1, 0xb2dddc9f7567d64f, 0xe07265f1587b01a4, 0x311c6a21772cf28b},
  {0xf655a358f0a179ec, 0xf42836f01ca64d46, 0x221dec5f524cac9d, 0x123ece96f666517c},
  {0x89be8f6f64facacd, 0xc7cd9c017de505c5, 0xb41e3f419ba15efc, 0x56a6169e166bd81b},
  {0x1b675a0adc52691b, 0x31a640970d33a3b9, 0xb60025c20d0411f2, 0x14a180e08eb3ea53},
  {0x0e4d60a4e6b7da68, 0x189828eda09be616, 0xd744d7c4190fac3e, 0x026950e17537aff8},
  {0x53ad3e539500d450, 0xcb3778cfd18caf18, 0x27c15048cb0f574b, 0xb2e3c40e3226a43d},
  {0x0010000100100100, 0x0104241005250524, 0x0011010004240000, 0x0001000000000000},
  {0x1010001524104350, 0x0010052511010011, 0x0101000005241111, 0x0101042411010111},
  {0x0034010531353125, 0x0420212442442410, 0x2035052504212400, 0x0424010000010005},
  {0x1100011524104350, 0x6025425563602125, 0x2510434424100456, 0x0101000011010114},
  {0x0010000535107750, 0x4344203401100424, 0x3405525424212010, 0x4344213404000005},
  {0x4317f523037045a1, 0x7371303463603755, 0x6745672644355745, 0x3024042121472360},
  {0xd2750105217322e1, 0xd651056706a73365, 0x0500050055155340, 0x1400013410051110},
  {0x5374d745307771b1, 0x7500476162702035, 0x1034166464353062, 0x152554215250c214},
  {0xf6871241d313409e, 0x950420354775463b, 0x7401725474257774, 0x07a276549430c344},
  {0xc042c0d098afc195, 0xd2368fa5c6dc95d3, 0x03173591414a21b0, 0x3361d23521727635},
  {0xa793454771b4277e, 0x41d60216d091909d, 0xf30202d5c3a69602, 0xa6b3870e61c23655},
  {0x158d1082377529ee, 0x97173e94f6bb546e, 0x555713a3133b6697, 0xe15e7099c3975142},
  {0xb6edb1a40393224c, 0x0255914f05b1f5ff, 0x430661b436fc70fb, 0x1535e260a3513011},
  {0x3110a8f4415c5c9c, 0x934b68db3fe5d7c6, 0x4f8da9fbe6698b46, 0xc7d1668ee5dac574},
  {0xd345d33393c073e1, 0xb6b3d053a71375b5, 0xe72636e4f181f222, 0xd26111722641e254},
  {0x7261815313c44124, 0xa6a65153e7c4c6e1, 0x806342c0c5c6c473, 0xb415925510015730},
  {0xf2922755c702111a, 0xb26044210344572b, 0x5534136461054353, 0x65d77712e000b130},
  {0xd5520292fd2ff775, 0x9543ab95d6c8e5c6, 0x07322297153922a2, 0x0110c64226703205},
  {0xe7a03fa7f6ec33e1, 0xf4a146a7967dc63b, 0xb71243f391f6f765, 0x95f7f00c04f53761},
  {0x359932b25146fea4, 0xf0671dd1c1df257b, 0x44b1218c01ee43f2, 0xd33f04b8d6b28743},
  {0x23cd02c5e2e1e79c, 0x0021f67d8067a682, 0x96af134d007a57cd, 0x448c90a0a322bf94},
  {0x8454a6d08b2c0f1c, 0x933f16d80d60b5c3, 0x09c85e50d0c309a1, 0xe5dea76ee468641a},
  {0x6210e01a75c01066, 0x43825310e09152f1, 0x8249226053b7c6c7, 0x748489cc418dae3d},
  {0xe4686e4863afa15a, 0x61da3723b33b0eb4, 0x44ff560545d2f7b5, 0x5286a67460550fa5},
  {0x0528a92b421f6c07, 0x03bf535375faf06e, 0xf72e158d66e451b4, 0xf7f826b767132fc5},
  {0x04767b86d4dd3752, 0x03370ab3c2f8e982, 0x55a1b290786d0456, 0xd7ede2b737775632},
  {0x409462818dcc94a5, 0x8aeb9e926915a94c, 0x80865e06a2b3b0d5, 0xf09c9ff8c4a190dc},
  {0x12935148a2765cc3, 0x6351360bc3413b57, 0xf3a2402a50b4e8c3, 0x90f2256a62f69c13},
  {0x81810eb436be9f79, 0x4529002e35d7648d, 0x316b10bcd21692c2, 0x032e04dbb46626b0},
  {0xd3b83c78469a2b6c, 0x9cd78ec64f21837f, 0x376b35380d59785f, 0x716fd29a6b04ee20},
  {0xd7f868f61ee5b75f, 0x0feaf8ae5ec40ee1, 0xd5ed28dc21f7f17f, 0x922394f0964e7d91},
  {0xc1c24e4d59c25667, 0x5bbc59581d4a3f8b, 0xf26e28e034918733, 0x6072b29cf7887bb7},
  {0x157705e2162e1240, 0x06969611b7649634, 0x1251326030704550, 0x7275c67765243251},
  {0xf2545015f31ab425, 0xf1f3034e45d34356, 0xc665e57275824706, 0xa250c231431746a6},
  {0xf12769955515c24b, 0x71ebe375e46f86f2, 0xa21ed3d282d10ae4, 0x9255526227520345},
  {0x5241361306b72417, 0x948da0fe85e62663, 0x43b3511de524ffcc, 0x41e6b24330200232},
  {0xec9e5decc52cd846, 0xe44640fdc7aa8747, 0x96affd4bb12bc785, 0x82ba55047e8fc8e9},
  {0x2dc8ac9c02e528e1, 0x53d0059704eeb151, 0x00de0e2eb7a9329a, 0xa53d7336de1ef1b1},
  {0x6630d36747d26488, 0x146a52b157706331, 0xa255273ae467db86, 0xc6d4ab81c33b8c08},
  {0x15825a74829fb482, 0xe5df7375631a37fb, 0xb00512393682188b, 0x71e3847fc19200d3},
  {0x353d2f766c1baad9, 0xd6e969e563f152f7, 0x5351cc44c6819db5, 0x75a5a0dfdcd86c3f},
  {0x46c816e865393251, 0x6128913aa72990a2, 0x776ddce2e0aa9b02, 0xc15285d57c9ead41},
  {0x14cc5bf1bebcb87e, 0xcf6af16cced29a50, 0x902e9900c39b8645, 0x06c85896270159e4},
  {0x8313dee0160da79b, 0xb76dd11620bc9aa2, 0x63c4d186b57f312d, 0xc607589cd6390663},
  {0x0a7afd0a7fc20c7a, 0x040145240d58fa34, 0x1c6569f273211373, 0x761b58b925a6547f},
  {0xfc92b16c7bb7952d, 0xe4d503b4803cfa4e, 0x11a0648f9b233905, 0xe104712207c3be68},
  {0xe39d92cc9894d562, 0x6af7b6c37e753ef8, 0x55a27a748d6b95c2, 0x371785d320cac486},
  {0x81fc23a4bc4bc403, 0x3bc6a8c108a74653, 0xf2804b00d1e7dfd6, 0x0274ae27d3f48f5e},
  {0xa491a5f2d13d3758, 0x17e54fac76ddf498, 0xf69e447b8ecaa4e4, 0x13dcf2c6033746c9},
  {0x4546d582bf5bf53d, 0x204f70e824f5f622, 0x37ed587b3bf9bbe6, 0x9227b6cd7f5edc3c},
  {0x4a991d57072afdfc, 0x70d3c9036367314f, 0xe6c5a157394d36cb, 0x224dce5df5dcb0a5},
  {0x36708052f105dad5, 0xc3b6e2043644f92b, 0xc3a7300ded000fe2, 0x91f7a72ab613718a},
  {0xc7f41297c504c56b, 0xe5190e73676dabeb, 0x11a1098aad2bfe12, 0x15a176fa6f4b7c76},
  {0x4a45fe190a8ab358, 0x945647ddfdab890b, 0x3da6d129e1dcaf98, 0x21adc28b4c260263},
  {0x8a104ec1da9a8de3, 0x861bbbb68284ffec, 0x77fd55ca9108ac76, 0x140d0c4c470c8272},
  {0xdbb5ad0df2843668, 0xf7930f22e097458f, 0x912d30c0d92916ff, 0x4109a83f945db905},
  {0x03ed02b314f55118, 0xc2f992ea27d0d172, 0x87d9f68919561839, 0x844fe0da16971f62},
  {0xe4a7cf304c59de98, 0x8271d3cc48bb4284, 0xb5a2f1cd298f330a, 0x05038d9cc83ad35b},
  {0x091f0b10433b6a75, 0x25cf53ca737c2925, 0x18909a7b29d29994, 0x4381379c8a9a29a1},
  {0x5131a1036a452ce2, 0x013c46842e200904, 0x03b854f056307f37, 0x744f35ccaa356fd7},
  {0xdcdc66a47375656b, 0xc6b206b03bb94b1d, 0x21b31be11c45ab14, 0x201c1eca02819d05},
  {0x5bb5a4c2df3d41d2, 0x1fed53a0c92de026, 0x794928db4e4a0141, 0xa4aa052f878b9b18},
  {0xc84b6b4e3ff2a6a6, 0xc56f63ebdff9721a, 0x4833eea3427ee5d0, 0x02c5d49754fa26f2},
  {0x18d08937094431cc, 0x34b899284025b254, 0xbb9ea3e1bad7032b, 0xc2d7305ba43608ec},
  {0x410436b0132b7135, 0x0115845110245221, 0x56547227b3310703, 0x6765c20131526670},
  {0xd22217d4d1e28135, 0x97a6a61f36962274, 0x9125d233f3971602, 0x8525303404531682},
  {0x010026b0136931a1, 0xb04f35b9b5c68550, 0x721f15a561474cb0, 0x34344561210123f2},
  {0x36c4c3c441db43c3, 0x65c3c31701c7873b, 0x154f7194e792444a, 0x65d3f755515644c3},
  {0xbbadbcccffef7c9a, 0xa297b83d00667281, 0x3588dda4e720004c, 0xb55682841eaea0a8},
  {0x207213f1c0a4f35a, 0xc014c60fa1009505, 0x7011764002552476, 0x44d6d33f36979350},
  {0x938ef3b5dc3f6d4f, 0x157fa28bb456d2ac, 0x957aa3d5a7e0cbb1, 0x763ab78d90c76357},
  {0xf11d61b232a722df, 0x12936671849177a6, 0x74ef0176c15fc6f4, 0xa501d73f428236f5},
  {0xa6af1e9494361343, 0x842776b6ce0ba2e9, 0x4c2eb0aae36b54fe, 0xf17ea1965d822648},
  {0xc259821405b1c1da, 0xe7a7c52dd3677104, 0xe166634e320ac0b8, 0x62645733018444a2},
  {0xd014ff9caf3ebdb5, 0xc7ef17393bbf917b, 0x4dc53ac42473c895, 0xd25dc65ce3fd0c51},
  {0x760a529c68b6f042, 0x90dbf86800de7a4b, 0x13f0b0cf928ae655, 0xd3c9509fe203425f},
  {0xecf1098563524795, 0xe455db7683d350ad, 0xd1b1770bd56c6884, 0x30db7f05b6b90ee6},
  {0xc24c65157396dbb9, 0xe5f6961b6527bc1a, 0x11a4a550b89e16a3, 0x81dbfa0161ac30d7},
  {0x662ed8083c42551f, 0x31449a684cf4b906, 0xbcf9db0ce4b12a7c, 0x72baf422e37d943d},
  {0xd70ac927023c1f3f, 0x879decb88ff0d3cb, 0x4cb70f783351155a, 0x2000ce52a4e71564},
  {0x55ed477443be5700, 0x52d1aaa3494980e0, 0xfe62e95e682cfd42, 0x063f3da813d6a67d},
  {0x728b602ec1b477b6, 0xf686400173f6849c, 0x91628a69c4245937, 0x046f3bac2a0054a6},
  {0xb6e3c5e764a812ed, 0x202d6e310badfc0c, 0x7f530a4d9fcfdc49, 0xb5fe7319451b5a86},
  {0x6254101c089253a5, 0x26070d82044a898e, 0xd4f3d70f92e47b8c, 0xd7f02fb290de4867},
  {0x4d714a77298d5a1a, 0x71108f3889374159, 0xea05cd8767ebbddb, 0xf1054a5c50e2b501},
  {0xd3bb25102684aa0a, 0x831e76cfe0e77b91, 0x4307f82a8be6b933, 0x946b7cbf5df5a973},
  {0x96dd0a423af1a0df, 0x37ba217f88185d57, 0x2b5ba0a857322676, 0xe557d9ef4a4d43e1},
  {0x53ae7ae9b9773441, 0x04dac400ab100c24, 0x98aa09b59632f899, 0xd15325bb747af757},
  {0xb7991f7efd1b6958, 0xaa3ff2343e5344de, 0x67e7ad93b84baf46, 0x87aa906bd1bddeb1},
  {0xc074e12832fbcf34, 0x1431efcb88c64ba9, 0x73ef6d216c2186de, 0x078c48fa47e780d1},
  {0x47d7c38036392d00, 0xdc99fc3678a47af8, 0xd08357d290b99913, 0xc5d7b24fae85c663},
  {0xb1472abc32edab52, 0x47554aecfb938baf, 0xc2feac13eaae3425, 0xa58cefa372a218e9},
  {0x5ed8aeeac66aff52, 0xb48e2c239ec43746, 0x8a359869006e2ecc, 0x44249e6da0c28ea8},
  {0x06201261a78e6007, 0xf27032d38f67c104, 0x5051ca7797c8e704, 0x80ae964b353ed913},
  {0xb0f61fb888c6c5a5, 0xb5031e3c0c668b1c, 0x6012d62ac1fac0db, 0xe24b27ed5ae30ca5},
  {0x9910454ced19faca, 0xd20c862cb7568dfe, 0x52c4c0038923f922, 0xf0801994844bf375},
  {0xdae28ea07452cf0a, 0x47e122fad3f87ae6, 0x3712dca4f1799e89, 0x62e461ae4adc7034},
  {0x6d793d35a30b5dc6, 0x13c1638a851c240f, 0xb0d27762f434f959, 0x039eee3cb6bda436},
  {0x38931b541659fa94, 0x515a4af085e67955, 0x90c35f59e8010d64, 0x27649a0539a565d1},
  {0xdc6d7ec2ef14a9b2, 0xe6878c7795a5d1dd, 0x846756efc67a9428, 0x475d9a31924ffda0},
  {0xc48b9a688ae364ba, 0xb1e32b1a81a008af, 0x246b2dd60403d957, 0xc47e6e809c917086},
  {0xbb679910a79eb337, 0xa0998f9d6525075e, 0x217effc436d0b6be, 0x165870365e6d330a},
  {0xd3990cd8557e78af, 0x9313139db68e4969, 0x819112911ebf3025, 0xf49912aaa52676db},
  {0x06fa35dda37a9816, 0x021f99be1d8b9330, 0x3fad9f3374e0ed19, 0xd2d472b272caf547},
  {0x6e42195f6d5b7651, 0x25ef1749efcadaa8, 0xd9cdef5a155057e1, 0xf5a033a7c70bfb81},
  {0x3ab4fba6920d0e13, 0xe1233db602e1fc6f, 0x7189f4e5770e55a3, 0x22a66025a6845db6},
  {0xbe8109a6ab85579e, 0xc6cfc26044e8053a, 0xb68f22ebfdff3836, 0x323b07de2765286b},
  {0xa98f30877e277921, 0xe50c17b3978b4cb8, 0xa93cad3a0f31203c, 0x7226b6f2b81ab3d6},
  {0xc7ff992deb454a4b, 0x497446b62ce506f8, 0x229509656fa2df28, 0x735dd770175dc5e9},
  {0xbf762d4fa68bab08, 0x73e979d19e0d4e21, 0xcf99626bc234e78f, 0xf08d46ad9895cb67},
  {0x265be384115c1234, 0x2a3960e80ed6a8fb, 0xe0c4b12182e3fa8e, 0x41807bc32d1f1cd5},
  {0x79d28f5dc13a10d9, 0x7ffd8444eef57cd0, 0xd2f7b33ee9f61ee2, 0x947e01df0ff5f7aa},
  {0x8de0cf97e5f3c787, 0x81987bf25232ea82, 0x1393564276405c23, 0xd3684d0e110e6449},
  {0x5103b45c8dc14785, 0x07174ebe9caca273, 0x7e7f51b1589aa209, 0xc6406353ba32b434},
  {0xee9960f53a1f66b4, 0x51572c8279ecb93d, 0xfbd29c804fae4a81, 0xc616b585d35e7c04},
  {0x556c61b40c0b601f, 0xf199529f3c06e4d2, 0xe59a2b93eb3e7736, 0xb16f2d8e374756ce},
  {0x2d17bcb101688195, 0xc456b0c7d67be032, 0xa2e1ca5ae1884cff, 0xf0243f128c94d126},
  {0x921f8a6467a8edd8, 0xb3c055f9a3bdd8eb, 0x5030026d1bf56268, 0x91bd74acf087ed70},
  {0x30d75e098b5d6ef1, 0xd1857a7e8b523ba7, 0xf2c6d2966123ba14, 0x6091ef8e4f9d639b},
  {0xaaf15c2940fbe189, 0xa7c9dd4108d5b5ae, 0x79942c3665ea25cd, 0xc0ea5ac250c0d6b9},
  {0x6df885267f9fabdf, 0xf3143bc5aeb6417c, 0x62c68cae3c5469fd, 0x76c8d69137983e81},
  {0x6d598beb6fad7922, 0xfbb69681bd445d50, 0x81c4e3bf00ee32bf, 0xb4c95c3fa668016f},
  {0x1e655350343ba045, 0xa2811405c27a00d1, 0x1ac8e1eed99725ed, 0x63489538515bc41d},
  {0xf102f2929ad898f0, 0x9fd4335a063debac, 0x780617a17dbf9ccb, 0x4c5a00ee784a928d},
  {0x7c701bacce41fec4, 0x63f7034e76aa1645, 0xe361a7bcdeeba81b, 0x11878863701bd422},
  {0x0e6289caf29143ca, 0xd103fed9ee74bfb2, 0xac3b149e97b6f9ea, 0x258c04706d85e86a},
  {0x4ce15fe772b60e38, 0xd2af50327017490f, 0xf085878dd210ff65, 0xb08a94ef47110bc5},
  {0x42ac3e439411d550, 0xca335ddfd4a9ab3d, 0x37c54058cb2a535b, 0xb2e3c41e3636a43d},
};

static const GF aim2_e2_power_matrix[AIM2_NUM_BITS_FIELD] =
{
  {0x0000000000000001, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000},
  {0x13269d7dcfc555c3, 0x6fe13874c42fedfb, 0xc69f003d9d5abb9c, 0x05636fd04ebf7feb},
  {0x7a273dd9fcec7e15, 0x42cd3eb54144ea68, 0x5a88aaa3ebaacdff, 0x527284e39fae2053},
  {0x56bb9ab537abf542, 0x768c3d772850c862, 0x0160d91d288fd0e0, 0x342e111e0a022022},
  {0xcdb998ce4b3eee2e, 0x78984c4dc99c90aa, 0x2bb89f84c00275b6, 0x75c6a0cc065fd4ac},
  {0x74b2cd2360cb32af, 0xbde82f7cf42dd1bf, 0x7ceed82d54d965c4, 0xf4e9f207aa17f2e9},
  {0x995d5aab614ac6c0, 0x1563800b79242f35, 0x1d940184c4509090, 0xe6558fd024716b90},
  {0x8d0b793b4375cc8a, 0xfcf792217776a3ee, 0x5da44008043b7450, 0xc77adf87407cf838},
  {0x00451596f23df45e, 0xd8bcbc0d7ae8534f, 0x02c26abe3748db45, 0xb37e029dc51a4b41},
  {0x177dbfce6cbc8c0b, 0x62cdd72c8cbd2d2a, 0x568802d992bd7a2c, 0xd0082d2193b6e383},
  {0x221e6872863f45c6, 0xbe5a9bce6c00df76, 0x98c076efe1cfcc67, 0xa75bdc7ab5c142a9},
  {0x088d4e8e27e0b74d, 0x71046740fe7e6c5a, 0x20123cab6052c1d6, 0xa7135d055351c99b},
  {0x46176449341c7657, 0x2a7936011468475e, 0xc347e166dca96014, 0xd79326785eee3555},
  {0xc6b77e5a8b6dcae9, 0x6dc641a8e07c54d4, 0x37055c3ed77341a8, 0xd75eaedd0ec6f1d1},
  {0x5240b9b6f3433443, 0x7b7d965745400c05, 0x4542be5aec50ec53, 0x13e6ac8f2aac12a2},
  {0x66c30b9da469d401, 0xcd5dbf02dc359172, 0xf16b3e62f8a57e1d, 0x362c2bc9345b97ed},
  {0xb2a65d5f7da755e8, 0x11df10d6ddd9eb84, 0x433468d75cb64470, 0xb4a6ffd454c82b2f},
  {0x1c87142145f7c112, 0xde2854fa4939dc0b, 0x10a503b51b7c7a19, 0x174f91701431e1b3},
  {0x60d8fb32b890cec6, 0x27d95c11548f693c, 0x30fce7ce95e950b3, 0x210559008a309578},
  {0x5de49c870dd8fb60, 0x1f480e246bb2c961, 0xdc5efcb1f4ee90ae, 0x165c3f5b62136c5e},
  {0xc17b4bbe4b5780a8, 0x690f1102a6decffe, 0xa26e146710d9cd7d, 0xc7f278fb3f02a99d},
  {0x4fe7916de7e17f1c, 0xe9e59586ac0a7185, 0x092b72935bc23437, 0xa306568e985edbfa},
  {0xc05330df507b35c8, 0x944475d0eb5c89f7, 0x34a3653b083969a5, 0x97e431e62e205633},
  {0x19fe581ef3e9a896, 0x720ab1851376eff0, 0xda5ca1af445dea40, 0xe3899fd1cdc93f2f},
  {0x7a18d867d11567d6, 0x14e706af946787cb, 0x2ececbd0e726236a, 0x66a864e0c387e806},
  {0x0a0a9e1dc2c9d30d, 0xa1bd85358585db7a, 0x78f90bb68d83e25e, 0x2275165a7e496039},
  {0x23f2e1a2057c9892, 0xb7f503272b51fa8f, 0x0ecf56cbb57a6021, 0x77f77f889ecb3e74},
  {0x237633913a45a827, 0x3a2c98b4d38d139b, 0xbc1dfd5ddab4bb19, 0xf2bcbdc105b017fd},
  {0x9a53645fca466120, 0x07335188ef82289a, 0x9cdd8f1434ddc4c7, 0x25afc28ddf0c0ea5},
  {0x0166bda62c3c97ac, 0x4821343275a35741, 0xa4a1f8ef377f5177, 0x3008d4b041fc0802},
  {0xed498663eb9138f0, 0xb16289e1ea93949b, 0xa2476ced73badf6e, 0xb384ce50cdee1d75},
  {0x25430e5e2ea409d8, 0xf8909d2164becc11, 0x77663884798e456b, 0xe11b963640c6a7da},
  {0x2a5ce7930313e789, 0x01a1b717dd5e72f3, 0x674b4810dda58bf3, 0xb348d6cffeee2602},
  {0xe4871c9932b98648, 0x90432c7798b61577, 0xf803346f3989e611, 0x176c5f43490e3127},
  {0x28b7ff52a8d039f5, 0x2549d26014bcb371, 0x7705b13fd068e5f0, 0x22f60aec7063b440},
  {0xa90087e5804b094e, 0x17b587e9f7b1334c, 0x7e9128a8fd49f502, 0x10a15de60dcc1259},
  {0x676fc8232449f7f5, 0xa45eba0b86ee4f8d, 0x48d0f0583763ed04, 0x9430177369350009},
  {0x8bb187487d0ca392, 0x8b34c408cf71198e, 0x4c5b9033c740f6cb, 0x15165d415ea592e5},
  {0xe25b8fc9315d8b10, 0x6f067bcaaa5db46f, 0xc0d574e6df163bcb, 0x76d62e45eeb26cb3},
  {0xc7bb4eaa81af7e21, 0xc0c25e2c4da66ca9, 0x20a5b7a6ef682683, 0xe0c40a42bed8c878},
  {0x340b283a1f67eb72, 0x94c68ac57747d7b1, 0xaab540d8883c7e78, 0x53ffb196e81fbce0},
  {0x03d1fe920cc5c8b6, 0x2d058e7c02de80d0, 0x349140f34518313d, 0x52d8d34dce452897},
  {0x3daf5481e615a4ec, 0x1d21ddb2b19865a7, 0x28572f8e3caef8c4, 0x94f0069367dd5a9c},
  {0xf97efd31544a2432, 0x79cc100bcd1c95c5, 0x630dd7dbdcda2efa, 0xb0c94889efaeabe6},
  {0x1855a973cd69d2ac, 0xa249d1e68760fda5, 0x9bd185166791f0b0, 0x73aad654a16f87d5},
  {0xb64f4c4f69887572, 0x0dd0ddfafeaec759, 0x9a2b2e01a2dfdf21, 0x23e6842e19958e74},
  {0x47126f2ed9d35243, 0x2dd26a5dc07d8ab7, 0x5f7a0864bae59fef, 0x84bd4c2d7eef707e},
  {0xc2b75aa6809fde33, 0x4e05ff4138a1458a, 0x4283e814ca9b30b5, 0x46b1bcf0f62d4313},
  {0x83f0c7c594f6cf9a, 0xdb8a4b8e5dfe204e, 0x44a803aecd550290, 0x96cc8907871fc11e},
  {0x7ca33f7d36e71a53, 0x609b8f2296791418, 0xd9e9118ba8ddf5e9, 0x813002deae63def5},
  {0x5e3805abc5d66c85, 0xe95aac205db8a39d, 0xfad61d269550a976, 0xc0c3e22037926992},
  {0xf3ba3f8e2a564d34, 0xfd74426f936299c0, 0x23bb54e8112b82e3, 0xc5afe8e8365a6000},
  {0xb733edd6855182ef, 0x5ecb1ae3728f48e8, 0x3b8b1ce5bf96e304, 0xf3aba2a7bfac4c59},
  {0x78f2ea71794eaef2, 0x59f25ef7fe359b84, 0xacfd3e59513654c8, 0xd1e24fda7d0c3936},
  {0x288da25da8b17fb3, 0xbe107e7feb777a7a, 0x166db15573baae6c, 0xb5ccbf5cfe3e5135},
  {0x4637849d0285089d, 0x4f671ebc0437c2ce, 0x188565bc785f8268, 0x712dec2cd1ba005e},
  {0xa25a6b6a471a00b1, 0x6e1a6a380bb57611, 0x3ef50b155eddd23d, 0xd3788fef109d4e3b},
  {0x4f403f37eba563c1, 0x76a201773cddd009, 0x58fba6bec18e06a6, 0x11a19d4cbf2a6331},
  {0xe3e6bbb73066a175, 0x9748c56fec4b9fa1, 0x406aae141855018c, 0xa1410c0e735df446},
  {0x5e569e71e70eb719, 0xa673071887dd4687, 0x07055d8d0a23d785, 0x74d498384aee1190},
  {0xa0e8a89b6fb6984d, 0x908716f3ce5edf66, 0x0a2b9e842b73e729, 0xa1b9171e0b83204b},
  {0xbe7532657aadaa20, 0x1b66940116e06582, 0x7385fd540009963d, 0x847a9b51570e7ff8},
  {0xe9395fd61662cbe6, 0xb3a286d4b91d1353, 0x455b0689d3ff2d83, 0xd56078fc7681e787},
  {0x8b470957a3441b8a, 0x7df431ebbf7e447b, 0x0e0f4fa397edd83c, 0xd793865c1388620e},
  {0x7b29927808bfa739, 0x96e65ce20d51654b, 0xaa8fcec0d3c045c3, 0xe5f31c0e239b4fea},
  {0x5525c2a74e77bf9e, 0x88cf3be85881afff, 0x7c81312941d70c3c, 0x23d8a44e23a9c737},
  {0xb869097f96d421f1, 0xfc5054b0f253daf5, 0x1c241e84b424d6aa, 0x32b29f522eb351e7},
  {0x6a466e2ed7c0ad0b, 0x5590c446ea6f583b, 0x56d2464d3ee4d099, 0x068910c7eb32dd95},
  {0x71139d1bc66bb641, 0xb3a1027da065feea, 0xe04294fcf6174557, 0x81dae384498adb46},
  {0xf43ed00c527a209a, 0xa5754026d1f22c89, 0xc78a8d365f196923, 0xf5154817fc84f220},
  {0xae764c7fe7341054, 0xffc86134dc4d880f, 0x1b6a1e1530d66862, 0x250c95737b7b8284},
  {0xbfee6b3c1e46c128, 0xa78dc08ba0e7251d, 0x3a95f11bcef9d4c7, 0x34f2831709c6a420},
  {0xe3a3c1aa9e2407d8, 0x4c1a200af1077851, 0x8965a32110544d77, 0x6354a05036f3f5a7},
  {0xbd108a58fc17d8a6, 0x61b0351824a54794, 0x499e7fd9fdd626df, 0x850217a6be595511},
  {0x53f2510fb68b5c61, 0x5b122cfd2501b4ba, 0x7fc88679758e8262, 0x233472936a675422},
  {0x11965eaffc401c95, 0x0af31e003ba1fb12, 0x2facfdd6611b7f8b, 0xd67eaae060c88abf},
  {0x6fa46680edff5f3f, 0x454b6266e25e87cb, 0x9addf096cb1df0af, 0xa6de67c1da83476b},
  {0xbf6f0cb8a600033a, 0xf520f28cc3846c4b, 0x008f972a2108bd6a, 0x55bbe0da272b6cb0},
  {0x9bf38905d29c13e7, 0xc50cd62db6acc3da, 0xbb9b791e0d47ac11, 0xd54b025508c245d8},
  {0x3a2547ab532ec9ff, 0x79495ddf670c8bc8, 0xdf4ed2dcee44e1bc, 0xc2e52f1fc1f7d4d5},
  {0x4800ee52ee97ecda, 0xc9d9b772550e380c, 0x98506ba8ea5ec019, 0x21ffafa8b46c668f},
  {0x3464a9138085b307, 0xf67a192be113e9cc, 0xfdd61b66e0e162dc, 0xd612aba17d397d2c},
  {0x16207c45e571aabf, 0xf2583066040bf4f7, 0x4bc24730dc4d62f5, 0x608b3d1e61a60b2f},
  {0xc2a6d2c707faaab1, 0xc9cfa575f99f891a, 0x61ea461507f40f96, 0x67104299d7331a82},
  {0xaf1c8fcbed1f1699, 0x985767a5dbb95b90, 0xd6ae3b3279c96a14, 0x275ea501029834e7},
  {0x4e19e32114de1e9c, 0x165f71d116e0afb9, 0xe968cbf378c1a2f7, 0x912182eb2d02ef2d},
  {0x6e4e3c81caceef19, 0x85f15b2e37fe2cbe, 0x8ae88fcc89bb8687, 0xe50b4d7659484c7a},
  {0x80353d06c9930d5c, 0x723d1f993acaffad, 0x89e273ac935dc5e2, 0x51356090a9eecbf9},
  {0xc3bd743bf118e69e, 0x78fe213d42306293, 0x90638ea842ff3668, 0xb0addcda3683625d},
  {0xe26008c6b83cc264, 0x74bbbd5777680be8, 0xa8892126f9cc485a, 0x54899977a5cc34a1},
  {0xd19b2baf7fa0c771, 0x39d199b5dfd41569, 0x7c3c66294bc7b31d, 0x81bb86cd53109ac5},
  {0xe4a790156b11f26a, 0xb496c49018830c99, 0xf19e574456b9d549, 0x867aa70b9bbd4fd0},
  {0xb8ce927c2afbcba9, 0x3ae3f9d11d478318, 0xebdecea6a113ffd6, 0x071def720f45ca33},
  {0xa18c4347c3dba5da, 0xc231d50db69b59f6, 0x784caea3c01900f9, 0x21b179202d1177e0},
  {0x48d839b0e148b37a, 0x119910fe9c00220e, 0xf6959f7654a471b7, 0x138df428ee1ab05e},
  {0x2378b25ea2d743c2, 0x52a0660820b6ff4b, 0xb20d6835419796a6, 0x77d41062fb9a7654},
  {0x1e63666141c834dd, 0x534d884045bcdedf, 0x07b52ebe10206e92, 0x67cb1a5c5d2017bc},
  {0xbd489efa4249447b, 0x81b1f830bdd020d0, 0xb8db0042e390a71b, 0x90b877cf8d8200e6},
  {0xd91a2f7fe76f986d, 0x2c6fcd64257849b8, 0xcec2c4be6ecbe77b, 0x5031f045518f6b98},
  {0x3cc9f99a10cba6b9, 0x7df264605ea09f19, 0xc6099006fa2f35a0, 0xf31aa1999c65f2ed},
  {0x7322250ccd66f2d2, 0xa8cf62816a34838c, 0xf7bd30878c6d359b, 0x450a14aed0d49014},
  {0xf753996b7d7c1d54, 0x45e2b366fb683eae, 0xcef4cef44af75b4a, 0xd1e647d51db49a04},
  {0x257099ec419b94a6, 0xd4a8a9f3335fcd10, 0xa286788285415010, 0x023c9feb9c1e9901},
  {0x229d6fd7eed1531c, 0x04cefb6c19ff0062, 0x9130be016eed6e29, 0xa1a04435eb4cd39d},
  {0xefbd279ed0b045c6, 0xe8ec58f13b1a927d, 0xbabddf060b172c30, 0xa5fd98adc4c9d7f8},
  {0x0f859d44ce18448a, 0x07af518284a5a680, 0xff7565589bc19136, 0x72e50c2e9eaa580a},
  {0x6470f3d6724b5dd7, 0x8b0ebb24be876d22, 0xfb604e14fd34a2cc, 0x213fc1d31fbb7996},
  {0x50e1d4f6f24a3685, 0x69348d20cb64f7b6, 0xa13da095f7678267, 0xb63a6ac7a66c3284},
  {0xb0edaccd9a8698dc, 0x73d7ca79b1672272, 0xaed4ffd76475e235, 0xf36b5b0cbbb22a1b},
  {0x24acd40ab0b10aba, 0xafb39e3ea0656a92, 0xcfe743611a51fa5a, 0xb4f8251f0f0e0d41},
  {0xe8036bb95086dfdf, 0x3d5d0332c379fb16, 0x3029edc150437ed5, 0xf561ce7ace559b0f},
  {0x01047fd87eb154ca, 0xce04d75cd86f0d9d, 0x33f6d9a762e84d0b, 0x52f77f2619632746},
  {0x3fdf7a3e2584aaa7, 0xafdff63009b07776, 0x24496f671e85ade5, 0x35b2e80c0abfdee5},
  {0x4bb3e9185acc78b3, 0xe5634557a7f532a4, 0xa6a979853e645782, 0x97e9a6c3f5ed6068},
  {0x41685f9547d8c651, 0x6d4bade8828daeda, 0xabe0dcd781a5b523, 0x3528952d2a770f19},
  {0xe4e43b26b587ea84, 0xf0f3f420178def6d, 0xd48cb1f978a8bb2e, 0x25de266fb8567a86},
  {0x2906276141285c5c, 0x045688d8cac52240, 0xa1a62b2fa2474687, 0x917244641b004f87},
  {0x73897ebb86a40eb0, 0x0df1bc6722ab333e, 0xb7815fffa0c79792, 0x322111adf2c83d06},
  {0x4dd181aa27fc54fa, 0x47b557267a691a35, 0x089b8ed1303c2515, 0xe60b63596c40b943},
  {0xe574bb3f5e1d3fe5, 0x7e5e1dd1aaea6c56, 0x443b9d58176d285b, 0xa2c066cf80f1c62d},
  {0x9df2b1fe93b4cb69, 0x5dc5dcbd7bcd4304, 0x4cac45f5c51659e4, 0x9039bc7472f02b80},
  {0x81c7d14b2ff6f3d6, 0x76b7422e6f000e01, 0x23e23fa520ed280b, 0x50a4f9ded0d07978},
  {0x154548397391fa38, 0xb1ec123aeb772341, 0x22f40fd3abeee812, 0x0342edcc39a77162},
  {0xa7ef812f5e9d9ba6, 0x65de86bcc8071b0d, 0x4b9bbe60fe0a1fad, 0xf4f8322efc5e2f45},
  {0x21fbeab48a7c1136, 0x42736db042991d3e, 0xf78c442fd2ed07a6, 0x36228053a90abb56},
  {0x6ebfcec360d88021, 0x7deeafd7cae1b159, 0x6f32c272246a4999, 0xb2f984f6c2b488dd},
  {0x76beda6b3d15abc7, 0x1bc04ff70ef9d0a9, 0x75ec5c46c4854ec0, 0x77bd25a817826a51},
  {0xf79c8d9bd7aaf4f0, 0xae5add9fd1454f93, 0xd9f264167923d698, 0x273bf89c8b33a9ec},
  {0x20ba5517532e42a7, 0xd9991aaa0bcb040f, 0x81ec69b31aea8c89, 0x823ee1a07f410f90},
  {0x3e10957041e49998, 0x9746fdf5f3deb53d, 0xbae6be6d5a7923dd, 0xd4aa255a7e60b5f8},
  {0x453e76f50e50f914, 0xba084020e530dd32, 0x90e9982f02a0b2e3, 0xc1bf6d0c93565fd4},
  {0xbb44043183434a96, 0xb6839987e4d3fbf5, 0x780e11ff154ba921, 0x46deb765191c6fad},
  {0xf254860f62ddca11, 0x2b40c2147fcc1618, 0x9b9df4f2213a87f5, 0xf5d9f1982bf72085},
  {0x9ec887ef1dac7ea8, 0xf9b9f41cd1a90cab, 0x5106c66727088891, 0xa079314a8a7aa0cc},
  {0xbaca971f705d6820, 0x32cf35c216d31b74, 0xcda1b48f6a782676, 0x42dd0c61745b57af},
  {0x774f50e70700fa3c, 0xfe706a77d17875e0, 0x50acd4b9e4f085bc, 0xa70b2f3a3373b5cf},
  {0xa3d467e6532333ed, 0x9143409c675fea0a, 0x186d4c8b7de757db, 0x006e698e91bc1742},
  {0x042690d62241c815, 0xf8a04fddc8420797, 0x9ff8cf1394eaada4, 0x921b7749e0687334},
  {0x3ba03d72cd709236, 0x12f95d885e21e3d3, 0xba18560bb5d4d50a, 0xa3607627494476ab},
  {0xade31f9ca5377f89, 0x635510178eec1003, 0x3dca939c351bf98d, 0x339c87aee1cf78dd},
  {0xe45a6287cc1287d4, 0x7cf6c8c56ed07634, 0xadf6eda911dd0200, 0x87211a5d3722f0f6},
  {0x7b07d341c0de902d, 0x69838993df5c9429, 0xb8921642be862244, 0x555819247b006cca},
  {0x4b8ebd3e261a1065, 0xec8c767eb1653ceb, 0x482e17c892519544, 0xb61af0cc04b533a5},
  {0x4fb9d38c4e2f7113, 0x50030b8523699320, 0x5716f5c60cedd7d8, 0x0673e662c18aadef},
  {0x641233031f77a5fb, 0x1932c76990a0d465, 0xb79ab4fbf32c92e8, 0xc0a7370dd0467550},
  {0xdb899bf50910763a, 0xf026477f262eb097, 0x76b70a1b2163a0d4, 0x93a2873f23165f6e},
  {0xba2a66c196ce2eb8, 0x19383fd3ffab287b, 0xaed33c3223646076, 0x1274559077e98698},
  {0x035a94843c44ec7a, 0x6de99478a3c009e3, 0x8a7ecba43ae87e6e, 0x458c9cbfca30c71a},
  {0xe3695ac8419682c5, 0xaeee4d4d0392ec66, 0xd99792a67250c187, 0x91e0f202f4c924b3},
  {0x9c784cfbf5192c27, 0xc113eee0e80c2eae, 0x3f7b5a6101ce5f5e, 0x842e2d646ecd9d6e},
  {0x957028a6befc0d73, 0xcbb8df5afe2e23c3, 0xc00f5c490d8dafb4, 0x67d7ee99cddb8452},
  {0xac8c3e869f704d2d, 0xc928ad50bd4faf6e, 0x114a0001a078d1a0, 0x8375ad6cc681586b},
  {0x59a53e3fb149cca9, 0x69cf3f7ab419768e, 0x79d945a746a788b8, 0x979b7e9387ae017f},
  {0x41f7712568f43935, 0xf17647a51bb6cff9, 0x593eb0f68e21db19, 0x77bf0442e77fdbdd},
  {0xd430085cbe62c90e, 0x445d0af933a0c884, 0x92f5c9b29a5de145, 0x6778e9aad04a6c94},
  {0x4914b4bd446c5d64, 0x21b19c795fec736d, 0x72cf9cdf7fa1c0db, 0xf67226412058b23c},
  {0x1e7346a99e1464a3, 0xacb82da3ac217e94, 0x4d1f4486473e6c18, 0x23274da141c63725},
  {0xf58a0445c9b4903b, 0x4f196615648056a4, 0xeaf0d8fc78e51fe3, 0xc71e969830bec69e},
  {0xcec3175fd17dee42, 0x6fa60eda34cf3b0f, 0x016ff6fe365a227b, 0x148ed225daf52abf},
  {0x5eb5954a6c060dcd, 0x67ed2e3411fbde9d, 0xdaddfd054f15c5a4, 0x80e12ae0d1591ef3},
  {0xc9c76eda44553b71, 0x7c4675538cbdcd1e, 0xa2128f16928c1efd, 0xc13aaef8cfacc959},
  {0x525318d3ea7544bd, 0x6f3e0f4d85ce7b2a, 0x397102e6892ab449, 0xd028319bc9ef0676},
  {0xc55bc06690da6f96, 0xea6a73d17ce2969a, 0xfa21bd37fa658e1e, 0x32d421c8c9a9d437},
  {0x4f53f0e462a9f4f0, 0x18c65d2ba362d43b, 0x53b8871400599e70, 0xf291e9ac535cfe6e},
  {0x2a420a66918ee17a, 0x4dae04d613a5a05f, 0xc12c868048f09ef7, 0x900c4ca4fb306ac2},
  {0x357f0638ee05acbc, 0x389db47cc78620f7, 0x3c531ff5b9fff02b, 0x902c96f5fb2c18f9},
  {0x57abb6151ae9319f, 0x917bd98253c43360, 0x36b4e4e17d9c5182, 0xc2a4751705897c3b},
  {0x91ee0ad214084c1b, 0xfe17b657a9ea9054, 0x7b304880e7a3efb6, 0xd497c8cea46cf443},
  {0xb97e1c63dcc46441, 0x22898ec1ecb0f186, 0x40dd2915e34e92ae, 0x83e63e8886604034},
  {0xf159f13af4545efc, 0x6b0312cbfce549f7, 0x1632f9e6624b3c5e, 0xc387a21c7c20a6d6},
  {0xe81b4468c49ba628, 0x9962cd4b58abb1e7, 0xda2145ce9fe59f2e, 0x6021807944cfc8e1},
  {0x9e98852b17310f23, 0x3cbe1c8bceb45120, 0x0e165b29c57ec0eb, 0x305bf854fb1aea8d},
  {0x1c3dbdac479d54f7, 0x4cda9c1c1bbb1a19, 0x7d330c571f17bc88, 0x826548b30e26b7d7},
  {0x446afa2ca1809535, 0x8d3c9693ee673350, 0x7893a83f58de1ffc, 0xb19954f7647195ff},
  {0x21b77a7b577e945a, 0x0c3e91d3f1f89e09, 0xdd7b8e8a59fae93c, 0x6435f276c4582559},
  {0x4d0e6426007bc199, 0x5c13184bcf7dd24a, 0x26f1f87322e213d0, 0x97243e676a3eb387},
  {0x14cbfff5b787dedd, 0x355794e80f8cd847, 0xf2c951e3c0d77a3d, 0xe558cf2f7b5f2991},
  {0xf87b23ea7452e43c, 0x92521695b010b548, 0xb7af363918a98cf1, 0x473e6304c6f3f9cf},
  {0xe86f5e030902695a, 0x884c59759075978e, 0x862a4f44f20c857d, 0x2348092c2d62a7ed},
  {0xbebdf27580f800b3, 0x4c82348a99cfaf36, 0x7fec6e2fb343c70a, 0xd0a2b036a8d95707},
  {0x59ef03fcb5a57f39, 0xfb04bb079290dd73, 0x30e0751c7c8e4263, 0x4078bcf952cf1a62},
  {0xa19ffba37095d58a, 0x9d164dabb30dff6a, 0x16de88d2bac7642a, 0x8232b5dca704cbcd},
  {0x329dfc2b2636492c, 0xf0397ad762a31307, 0x78adfe730ebe751e, 0x5783b8d9d2f05dfd},
  {0xf2d6e8a736f23aa1, 0xe2102f9bd2267093, 0xdf2af690beecc500, 0x11398c83a817f593},
  {0xd46565aaafab2385, 0xddff3f9a0b99928d, 0x5eb2072a49c5a5ab, 0x53a03f6a8eb6a094},
  {0x57fb689ec7092868, 0xc2040eb173de1a44, 0x810031fb7b19e630, 0x53960a9b3b1ef568},
  {0x40007920454fbf71, 0xac025a589e98d1ef, 0x9e256036a7fbd143, 0xc13cf073bd649440},
  {0xd06cd6829f0fea3d, 0x2a51b1d71d1ac07b, 0x3546a5854571bbc6, 0xc30b6bf46c0b42fe},
  {0x62488646a13da231, 0xe28973393fb6f682, 0x9ed13dc9f5432f8f, 0x31b84f2be241c94e},
  {0x9bb19ea5428d66ae, 0xe0080b8616f3babc, 0x9610055711788ae5, 0x7652d184a46c90fe},
  {0x112c63f926d9850e, 0xe5905a268850e663, 0xb9fd3996e6d72608, 0xa7aa33543146d58a},
  {0x77de728df392f575, 0x637633946129f8e6, 0x72a867e08e3bfce6, 0x754f7149e15a365b},
  {0x3511c4139b98679f, 0x56a8a361da8cbe81, 0x2a34d15423a9eb45, 0x82ae1da57cd32e57},
  {0xcb3ecb886171f719, 0xfcbf82d884e8e020, 0xc6d2502bd1e6f6cf, 0x80bb7b1db5c2a777},
  {0x81b8745892f03d2d, 0xbc5f38b14116148b, 0x4b6d0194055b86d8, 0x241dbd17e3eb4ba9},
  {0x5bbc585152fcd142, 0x930f31c230a2050e, 0xabf51e10a3e969e5, 0x72a0a1c90ead638e},
  {0xcadb18ff93f7f93e, 0x1b8e009b5719bf82, 0x743c0ab2c8bc284a, 0x7144a02ff1130223},
  {0x41b95e62522de019, 0xcd3465a01c9b93fb, 0x236600ff15e70ef3, 0x3658cd0c29ea6f20},
  {0xb9c59bf0b27dc282, 0x47955c29304112de, 0x3f16c72af19bcb3f, 0xa0e568c9c5397d69},
  {0x9251cf7a209add18, 0x8e3a95a336fe4170, 0xf28c14a751527126, 0xb3d3a9a208590971},
  {0x5b129f35a37c28ff, 0xe3f8ba25b41817b9, 0x200b734d2501265f, 0x52344985724cceca},
  {0xa8e27fd1e60dffab, 0xa8ea4523b64f5aa4, 0xa475b8437f8165a1, 0xd644c1691c3c7548},
  {0x5ddae2f669e64957, 0x1fcef31f0b9af756, 0x3e6da61c7980074e, 0x206f828242ab6764},
  {0x33144ea9f76bb631, 0x9f36e03e21fa3065, 0xfe08e97dc86bceb2, 0x640b723c98cd7479},
  {0x1636152634146114, 0xc18c0793a80805cd, 0x2b106edd3834043c, 0x4191bf5c7fbacdf8},
  {0x429dddfd03ef7bc4, 0x4db9b9d6da197cd3, 0xe74baaea7f22abc0, 0x4364ff1e20f72e64},
  {0xca8a9a678e94da68, 0x6535f14dbed15563, 0x98f34f0a20bd3f3c, 0xd12c84164701e27f},
  {0xc02c8d4c379b7ce5, 0x7069499c81e1f16e, 0x9bf97727b1a05c04, 0xf27fa10bb0a78610},
  {0x4cf536f0cf11a349, 0xbd9dfa2a6eb41391, 0x565f1d6e23bbbc0d, 0xc76bbb697c18cf7f},
  {0xa17601bde8ac478c, 0x8db87c51403e365d, 0x4088a87a96d9c622, 0x31f82a7918dd0d06},
  {0x29ee14687120f04e, 0xfea2e736c3636d5c, 0x7f8c89823855588a, 0xf0da86215a008e8c},
  {0xdd645ec1d816c223, 0x0aa7edbc5ba5d0cf, 0xfced1c8e126396e5, 0x201b07bc6f65eddb},
  {0xfb25e20cd48f4855, 0xa8b3d1435e85371a, 0x3ee9acb3f939329e, 0xd075efbe502f25a4},
  {0x0541c9b35049c704, 0x94986dc9cd668f39, 0x17f4cfb2726cd68b, 0x508c14a670636ed4},
  {0xa2b783ac55d68039, 0xc130ab2d841d773e, 0xd6d29b14f588465d, 0xb790ad979cce43f8},
  {0x4f8ce0df03c43b98, 0xbbda15818c06d7a2, 0x380dd95f0f042fdb, 0x05f429bccfb597f3},
  {0xc742e63ad5c5f5e6, 0xcbcb225fbbbe33e2, 0xa8edf59089d52ced, 0xa0e788a338b45f4d},
  {0x20e95da4bdb0c82f, 0x3e63b532cc85e2d9, 0x163e3d2b90d4ddaf, 0xc71593e07530219a},
  {0x7992357ab8d37b59, 0x4aea96f315f3c064, 0x1ba04f945b33146b, 0xf65bed5593247ff4},
  {0x2d4ad59bdce5563d, 0x3a24253d449dc88d, 0x41c7ffbd062c28f4, 0x42734ae219aa9361},
  {0x644204f2ea9b71e3, 0xe551983ade3b5122, 0x1bc727382db55ea1, 0xe276d03e4bd6fc9a},
  {0xfb20c1e51a924e81, 0x2f795f1d4507decd, 0x154de4d0aca02046, 0x72ddcd99451381dd},
  {0xc09ac8020e255c2b, 0xa4eff29a2c29d3f3, 0x7977c4f4c2f24381, 0x349ff7a6efa4d791},
  {0xea5d2cd9592cb4e6, 0xf63dcd3ff0c8104a, 0x66d7254c1252ca0d, 0x822791068962c667},
  {0x7b9c477dde2ad4a4, 0xd3460c638eb797b0, 0x1889eaef7acad771, 0xb23db19bd8554e11},
  {0x6f1c469240cd647f, 0x31825907e279b274, 0xb97cebbf2c37c29e, 0x74ce50e87690b22e},
  {0xfb92d64637ac0508, 0x97999c37b92d0720, 0xa23a9e76c1578849, 0x66aa9c79979e14fb},
  {0xcf78e912e65a8877, 0xb7dcb878bdeec090, 0xe678ac56695a99fc, 0x0338870b34c11cee},
  {0x5529c228e771c374, 0xd8ab910e6e0a23f9, 0xcd86f7b11bf07839, 0xe3358c0867358f64},
  {0x7c0e69e5db7dc1c3, 0x355a9bbca9523a64, 0x86985b53d32a3f4b, 0xc715ea89b184099b},
  {0xac499c49b8a4cdc4, 0x22485e1df13ea826, 0xf91367c2ad8807da, 0x863b3b9193879ebd},
  {0x8086427544d93f9b, 0xf378d24905271a4e, 0x8a2211f2e881884b, 0x27f11aae6fbdeb19},
  {0xd4d702e312991728, 0xd57d86c18df5deb9, 0x68b550520aac07f8, 0x6163e0c25242d715},
  {0x0484539b5bd55737, 0x69b34b6b4664d575, 0xcafeeeea78048b31, 0x25a0aca017ec768d},
  {0x955f03fc32b86250, 0xb3ed04233eabbafd, 0xb4da5d10fb30568d, 0xa1d5c520656d8e7f},
  {0x18e6772ac0c7b0b5, 0x1e8c41bfa134bd72, 0x36b1b28f157526b2, 0xf5ac9222151e43e1},
  {0xb500af50c3647566, 0x181d28f85aca7575, 0x9a16455dfd6341a1, 0xc6d058b2c1e37c22},
  {0x01b46ff0be3c6ef8, 0x7f5abf4a7e4a72fe, 0xe18780f7372db81b, 0x91d1172dbd7c1d3b},
  {0x62e68a7598567ebd, 0x4654b8ed6f377911, 0x051bf02a5685ca63, 0xd08b010696df1fa9},
  {0x656ce860674f0d36, 0x8bcbf7bc1ef730bf, 0x00a0260df392d280, 0x33930145fd64eecf},
  {0x17743293297fc288, 0x5b59ca56522bb36a, 0xe58ef14098fd4053, 0x7444ed68eb16e657},
  {0x31beae245608121f, 0xea349f5c00e7cc25, 0xf076aacf6db8c528, 0x13c58f0b1e99ac1a},
  {0x910f9e30c8455d7b, 0xc1ebc494beb98220, 0x201a3557ec66e851, 0x610dd21bbd2f6b9f},
  {0x317d8fa79aa99e03, 0x7b670f771c4590dd, 0x77052e1a54ac4638, 0x17309eb8c690df96},
  {0xddae9fdfd80030d4, 0x84daf3404eae25e8, 0xe93997a2e172c485, 0x51f2159ecb7b5e41},
  {0x9f02a3e12da8bc2c, 0x1c746f4b943dc8e5, 0xb31951aeeaac4e5e, 0x0128a606643b4341},
  {0xebd158803af98ce2, 0x08e82db8ead7c10b, 0xba172e80caa61667, 0xf61ff900e1918b8a},
  {0x8c3c570f9ffae2bc, 0xff0827921f27e4f5, 0x6256d4a0913919b5, 0xc1f4fcc60f17957e},
  {0x648ade6556f9d114, 0xf2e85e1746058ffe, 0xc9605989ede623cf, 0xf3d09098541725a9},
  {0xc57b49460d911255, 0xc0767005f4affb44, 0x486c21436602612a, 0x87617ddb2a9643c0},
  {0xc2038cd71c6d3ead, 0x8fe1e58a5096a181, 0x51cde6590d0f6b27, 0xf59bf938475aa39a},
  {0x9d8138454badbf16, 0xaf8306904b15d8a8, 0x83bd9fd79c159b39, 0xb85db82acdbbf3ae},
  {0x560807274e8b13db, 0xb33b8a036f1617ca, 0x72bc05868c923532, 0xb7b8ee25c3388851},
  {0xc042df127c4f6747, 0x704ed715ba3ca7d4, 0x678f93c55bc0c5d2, 0xd2ee482f0bfe6c9a},
  {0xbd60c5ba33d87b10, 0x6c2ff096c60536d6, 0x0ce4b4b8c86a8f5b, 0x86a0bcebf81d6e4d},
  {0xf9384ef3a44799c2, 0x8b78ec1c676a7fcd, 0x5f7c3edb312b00da, 0x2390763c1712af67},
};

void generate_matrices_L_and_U(const uint8_t iv[AIM2_IV_SIZE],
                               GF matrix_L[AIM2_NUM_INPUT_SBOX][AIM2_NUM_BITS_FIELD],
                               GF matrix_U[AIM2_NUM_INPUT_SBOX][AIM2_NUM_BITS_FIELD],
                               GF vector_b);
void generate_matrix_LU(const uint8_t iv[AIM2_IV_SIZE],
                        GF matrix_A[AIM2_NUM_INPUT_SBOX][AIM2_NUM_BITS_FIELD],
                        GF vector_b);

void aim2_sbox_outputs(const GF pt, GF sbox_outputs[AIM2_NUM_INPUT_SBOX]);
void aim2(const uint8_t pt[AIM2_NUM_BYTES_FIELD],
          const uint8_t iv[AIM2_IV_SIZE],
          uint8_t ct[AIM2_NUM_BYTES_FIELD]);

#endif // AIM2_H
